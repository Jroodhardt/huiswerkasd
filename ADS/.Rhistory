importance(model1)
wine_qualfac<-wine_data
wine_qualfac$quality <- as.factor(wine_qualfac$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.7*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
summary(trainset)
model1<-randomForest(quality~.,data=trainset,importance=T,ntree=300,mtry=2)
model1
predtrain<-predict(model1,trainset,type="class")
table(predtrain,trainset$quality)
validtrain<-predict(model1,validset,type="class")
table(validtrain,validset$quality)
mean(validtrain==validset$quality)
mean(predtrain==trainset$quality)
plot(model1,main= "Model 1: Random Forest error graph")
varImpPlot(model1, main= "Random Forest model 1")
importance(model1)
wine_qualfac<-wine_data
wine_qualfac$quality <- as.factor(wine_qualfac$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.7*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
summary(trainset)
model1<-randomForest(quality~.,data=trainset,importance=T,ntree=300,mtry=5)
model1
predtrain<-predict(model1,trainset,type="class")
table(predtrain,trainset$quality)
validtrain<-predict(model1,validset,type="class")
table(validtrain,validset$quality)
mean(validtrain==validset$quality)
mean(predtrain==trainset$quality)
plot(model1,main= "Model 1: Random Forest error graph")
varImpPlot(model1, main= "Random Forest model 1")
importance(model1)
plot(model1,main= "Model 2: Random Forest error graph")
varImpPlot(model1, main= "Random Forest model 2")
plot(model1,main= "Model 2: Random Forest error graph")
rpart(wine_data_train$quality~.,wine_data_train,methode="class")
#####################
rpart(wine_data_train$quality~.,wine_data_train,method="class")
plot(model3)
model3<-rpart(wine_data_train$quality~.,wine_data_train,method="class")
plot(model3)
scale.features <- function(df, variables){
for (variable in variables){
df[[variable]] <- scale(df[[variable]], center=T, scale=T)
}
return(df)
}
numeric.vars <- c(`fixed acidity`, `volatile acidity`, `citric acid`,`residual sugar`,chlorides,`free sulfur dioxide`,`total sulfur dioxide`, density, pH, sulphates,alcohol)
scaledfeat <- scale.features(wine,numeric.vars)
model3<-rpart(wine_data_train$quality~.,wine_data_train,method="class")
plot(model3)
model3<-rpart(wine_data_train$quality~.,wine_data_train,method="class")
plot(model3)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(model3)
print(model3)
model3<-rpart(quality~.,wine_data_train,method="class"control = rpart.control(minsplit=20, cp=0.05))
model3<-rpart(quality~.,wine_data_train,method="class",control = rpart.control(minsplit=20, cp=0.05))
plot(model3)
m3.predictions <- predict(model3, wine_data_valid, type="class")
confusionMatrix(data=m3.predictions, reference=wine_data_valid, positive="1")
library(rpart.plot)
install.packages("rpart.plot")
library(rpart.plot)
model3<-rpart(quality~.,wine_data_train,method="class",control = rpart.control(minsplit=20, cp=0.05))
plot(model3)
model3<-rpart(quality~.,wine_data_train,method="class",control = rpart.control( cp=0.05))
plot(model3)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(model3)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3), tp_args = list(beside = TRUE))
install.packages("partykit")
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3), tp_args = list(beside = TRUE))
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
m3.predictions <- predict(model3, wine_data_valid, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
print(model3)
m3.predictions <- predict(model3, wine_data_valid, type="class")
table(m3.predictions,validset$quality)
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,valid$quality)
mean(m3.predictions==valid$quality)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
install.packages("partykit")
train<-sample(nrow(wine_qualfac),0.6*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.6*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.5*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="anova")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="anova")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="anova")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.7*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 5))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
#####################
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.01))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.02))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.02))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.03))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.01))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.01, maxdepth = 6))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.01, maxdepth = 7))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.01, maxdepth = 4))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 15, cp =0.01, maxdepth = 7))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(minsplit = 20, cp =0.01, maxdepth = 7))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class", rpart.control(xval=18,minsplit = 20, cp =0.01, maxdepth = 7))
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.8*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.7*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.6*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
m3.predictions <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
m3.predictions <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.6*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
predtrain <- predict(model3, trainset, type="class")
table(m3.predictions,trainset$quality)
mean(m3.predictions==trainset$quality)
validtrain <- predict(model3, validset, type="class")
table(m3.predictions,validset$quality)
mean(m3.predictions==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.6*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
predtrain <- predict(model3, trainset, type="class")
table(predtrain,trainset$quality)
mean(predtrain==trainset$quality)
validtrain <- predict(model3, validset, type="class")
table(validtrain,validset$quality)
mean(validtrain==validset$quality)
set.seed(100)
train<-sample(nrow(wine_qualfac),0.65*nrow(wine_qualfac),replace = F)
trainset<-wine_qualfac[train,]
validset<-wine_qualfac[-train,]
library(partykit)
model3<-rpart(quality~.,wine_data_train,method="class")
plot(partykit::as.party(model3))
print(model3)
predtrain <- predict(model3, trainset, type="class")
table(predtrain,trainset$quality)
mean(predtrain==trainset$quality)
validtrain <- predict(model3, validset, type="class")
table(validtrain,validset$quality)
mean(validtrain==validset$quality)
